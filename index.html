<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sumit Damor - Personal Website</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
        }

        .nav-links {
            display: flex;
            gap: 30px;
            list-style: none;
        }

        .nav-links a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: color 0.3s;
        }

        .nav-links a:hover {
            color: #667eea;
        }

        .hero {
            text-align: center;
            padding: 80px 20px;
            color: white;
        }

        .hero h1 {
            font-size: 48px;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .hero p {
            font-size: 20px;
            margin-bottom: 30px;
        }

        .cta-button {
            display: inline-block;
            padding: 12px 30px;
            background: white;
            color: #667eea;
            text-decoration: none;
            border-radius: 25px;
            font-weight: bold;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .section {
            background: white;
            margin: 40px 0;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .section h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 32px;
        }

        .blog-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }

        .blog-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
            position: relative;
        }

        .blog-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        .blog-card h3 {
            color: #333;
            margin-bottom: 10px;
        }

        .blog-card p {
            color: #666;
            margin-bottom: 15px;
        }

        .blog-meta {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            color: #999;
        }

        .blog-stats {
            display: flex;
            gap: 15px;
            margin-top: 10px;
        }

        .stat {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
            color: #666;
        }

        .contact-form {
            max-width: 600px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }

        .form-group textarea {
            min-height: 150px;
            resize: vertical;
        }

        .submit-button {
            background: #667eea;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.3s;
        }

        .submit-button:hover {
            background: #764ba2;
        }

        footer {
            text-align: center;
            padding: 30px;
            color: white;
            margin-top: 40px;
        }

        .admin-panel {
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .admin-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #eee;
        }

        .admin-tab {
            padding: 10px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .admin-tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        .admin-content {
            display: none;
        }

        .admin-content.active {
            display: block;
        }

        .blog-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .blog-table th,
        .blog-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .blog-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #667eea;
            cursor: pointer;
            user-select: none;
        }

        .blog-table th:hover {
            background: #e9ecef;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            padding: 5px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: opacity 0.3s;
        }

        .action-btn:hover {
            opacity: 0.8;
        }

        .edit-btn {
            background: #667eea;
            color: white;
        }

        .delete-btn {
            background: #dc3545;
            color: white;
        }

        .hidden {
            display: none;
        }

        .top-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #333;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(255, 215, 0, 0.4);
        }

        .top-badge.second {
            background: linear-gradient(135deg, #c0c0c0, #e8e8e8);
        }

        .top-badge.third {
            background: linear-gradient(135deg, #cd7f32, #e8a87c);
        }

        .filter-controls {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .filter-group label {
            font-weight: 500;
            font-size: 14px;
            color: #666;
        }

        .filter-group select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            cursor: pointer;
        }

        .sort-indicator {
            margin-left: 5px;
            font-size: 12px;
        }

        .comment-section {
            margin-top: 30px;
            padding-top: 30px;
            border-top: 2px solid #eee;
        }

        .comment-form {
            margin-bottom: 30px;
        }

        .comment-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .comment-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 3px solid #667eea;
        }

        .comment-author {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .comment-date {
            font-size: 12px;
            color: #999;
            margin-bottom: 10px;
        }

        .comment-text {
            color: #333;
            line-height: 1.6;
        }

        .about-section {
            background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(255,255,255,0.9));
            padding: 60px 40px;
            border-radius: 15px;
            margin: 40px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }

        .about-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .about-section h2 {
            color: #667eea;
            font-size: 36px;
            margin-bottom: 25px;
            text-align: center;
        }

        .about-section p {
            font-size: 18px;
            line-height: 1.8;
            color: #555;
            margin-bottom: 20px;
            text-align: justify;
        }

        .about-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .feature-item {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }

        .feature-item:hover {
            transform: translateY(-5px);
        }

        .feature-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }

        .feature-title {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .feature-desc {
            font-size: 14px;
            color: #666;
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <div class="logo">Sumit Damor</div>
            <ul class="nav-links">
                <li><a href="#home" onclick="navigateTo('home')">Home</a></li>
                <li><a href="#blogs" onclick="navigateTo('blogs')">Blogs</a></li>
                <li><a href="#contact" onclick="navigateTo('contact')">Contact</a></li>
                <li><a href="#admin" onclick="navigateTo('admin')">Admin</a></li>
            </ul>
        </nav>
    </header>

    <div id="home-page">
        <div class="hero">
            <div class="container">
                <h1>Welcome to My Personal Space</h1>
                <p>Exploring ideas, sharing knowledge, and building connections</p>
                <a href="#blogs" onclick="navigateTo('blogs')" class="cta-button">Read My Blogs</a>
            </div>
        </div>

        <div class="container">
            <div class="about-section">
                <div class="about-content">
                    <h2>About This Website</h2>
                    <p>
                        Welcome to my personal corner of the internet! This website serves as a platform where I share my thoughts, 
                        experiences, and insights through carefully crafted blog posts. Whether you're here to explore new ideas, 
                        gain knowledge, or simply connect with like-minded individuals, you've come to the right place.
                    </p>
                    <p>
                        Built with passion and powered by modern web technologies, this site offers a seamless reading experience 
                        with interactive features that allow you to engage with content through likes, shares, and comments. 
                        Every blog post is an opportunity to learn something new and join meaningful conversations.
                    </p>
                    
                    <div class="about-features">
                        <div class="feature-item">
                            <div class="feature-icon">üìù</div>
                            <div class="feature-title">Quality Content</div>
                            <div class="feature-desc">Thoughtful articles on various topics</div>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon">üí¨</div>
                            <div class="feature-title">Engage & Discuss</div>
                            <div class="feature-desc">Comment and share your thoughts</div>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon">üéØ</div>
                            <div class="feature-title">Easy Navigation</div>
                            <div class="feature-desc">Find what you're looking for quickly</div>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon">üîî</div>
                            <div class="feature-title">Stay Updated</div>
                            <div class="feature-desc">New content published regularly</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>üèÜ Top 3 Most Liked Blogs</h2>
                <div class="blog-grid" id="top-blogs"></div>
            </div>
        </div>
    </div>

    <div id="blogs-page" class="hidden">
        <div class="container">
            <div class="section">
                <h2>All Blog Posts</h2>
                <div class="blog-grid" id="all-blogs"></div>
            </div>
        </div>
    </div>

    <div id="blog-detail-page" class="hidden">
        <div class="container">
            <div class="section" id="blog-detail-content"></div>
        </div>
    </div>

    <div id="contact-page" class="hidden">
        <div class="container">
            <div class="section">
                <h2>Get In Touch</h2>
                <form class="contact-form" onsubmit="handleContactSubmit(event)">
                    <div class="form-group">
                        <label for="name">Name</label>
                        <input type="text" id="name" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" required>
                    </div>
                    <div class="form-group">
                        <label for="message">Message</label>
                        <textarea id="message" required></textarea>
                    </div>
                    <button type="submit" class="submit-button">Send Message</button>
                </form>
            </div>
        </div>
    </div>

    <div id="admin-page" class="hidden">
        <div class="container">
            <div class="admin-panel">
                <h2>Admin Panel</h2>
                
                <div class="admin-tabs">
                    <button class="admin-tab active" onclick="switchAdminTab('create')">Create Blog</button>
                    <button class="admin-tab" onclick="switchAdminTab('manage')">Manage Blogs</button>
                    <button class="admin-tab" onclick="switchAdminTab('analytics')">Analytics</button>
                    <button class="admin-tab" onclick="switchAdminTab('top10')">Top 10 Blogs</button>
                </div>

                <div id="create-content" class="admin-content active">
                    <h3>Create New Blog Post</h3>
                    <form onsubmit="handleBlogSubmit(event)">
                        <div class="form-group">
                            <label for="blog-title">Title</label>
                            <input type="text" id="blog-title" required>
                        </div>
                        <div class="form-group">
                            <label for="blog-content">Content</label>
                            <textarea id="blog-content" required></textarea>
                        </div>
                        <button type="submit" class="submit-button">Publish Blog</button>
                    </form>
                </div>

                <div id="manage-content" class="admin-content">
                    <h3>Manage Blog Posts</h3>
                    <table class="blog-table">
                        <thead>
                            <tr>
                                <th>Title</th>
                                <th>Date</th>
                                <th>Likes</th>
                                <th>Shares</th>
                                <th>Comments</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="manage-blogs-table"></tbody>
                    </table>
                </div>

                <div id="analytics-content" class="admin-content">
                    <h3>Blog Analytics</h3>
                    
                    <div class="filter-controls">
                        <div class="filter-group">
                            <label>Filter by Metric:</label>
                            <select id="metric-filter" onchange="applyAnalyticsFilters()">
                                <option value="all">All Blogs</option>
                                <option value="likes">Most Liked</option>
                                <option value="shares">Most Shared</option>
                                <option value="comments">Most Comments</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label>Time Period:</label>
                            <select id="period-filter" onchange="applyAnalyticsFilters()">
                                <option value="all">All Time</option>
                                <option value="week">This Week</option>
                                <option value="month">This Month</option>
                            </select>
                        </div>
                    </div>

                    <table class="blog-table">
                        <thead>
                            <tr>
                                <th onclick="sortAnalytics('title')">Title <span class="sort-indicator" id="sort-title"></span></th>
                                <th onclick="sortAnalytics('likes')">Likes <span class="sort-indicator" id="sort-likes"></span></th>
                                <th onclick="sortAnalytics('shares')">Shares <span class="sort-indicator" id="sort-shares"></span></th>
                                <th onclick="sortAnalytics('comments')">Comments <span class="sort-indicator" id="sort-comments"></span></th>
                                <th onclick="sortAnalytics('engagement')">Engagement <span class="sort-indicator" id="sort-engagement"></span></th>
                                <th onclick="sortAnalytics('date')">Date <span class="sort-indicator" id="sort-date"></span></th>
                            </tr>
                        </thead>
                        <tbody id="analytics-table"></tbody>
                    </table>
                </div>

                <div id="top10-content" class="admin-content">
                    <h3>Top 10 Blogs Performance</h3>
                    
                    <div class="filter-controls">
                        <div class="filter-group">
                            <label>Sort by:</label>
                            <select id="top10-sort" onchange="loadTop10Blogs()">
                                <option value="likes">Most Liked</option>
                                <option value="shares">Most Shared</option>
                                <option value="comments">Most Comments</option>
                            </select>
                        </div>
                    </div>

                    <table class="blog-table">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Title</th>
                                <th onclick="sortTop10('likes')">Likes <span class="sort-indicator" id="top10-sort-likes"></span></th>
                                <th onclick="sortTop10('shares')">Shares <span class="sort-indicator" id="top10-sort-shares"></span></th>
                                <th onclick="sortTop10('comments')">Comments <span class="sort-indicator" id="top10-sort-comments"></span></th>
                                <th>Total Engagement</th>
                                <th>Date</th>
                            </tr>
                        </thead>
                        <tbody id="top10-table"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>&copy; 2024 Sumit Damor. All rights reserved.</p>
        </div>
    </footer>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, getDocs, addDoc, updateDoc, deleteDoc, doc, query, orderBy, limit } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyDMdJW_MnjSfiKBjKdBLT_zXvVW_qlYKKo",
            authDomain: "sumit-damor-website.firebaseapp.com",
            projectId: "sumit-damor-website",
            storageBucket: "sumit-damor-website.firebasestorage.app",
            messagingSenderId: "1059726539734",
            appId: "1:1059726539734:web:e8e8e8e8e8e8e8e8e8e8e8"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        window.db = db;
        window.firestoreModules = { collection, getDocs, addDoc, updateDoc, deleteDoc, doc, query, orderBy, limit };

        let allBlogs = [];
        let currentSortColumn = 'date';
        let currentSortDirection = 'desc';
        let top10SortColumn = 'likes';
        let top10SortDirection = 'desc';

        async function loadBlogs() {
            const blogsCollection = collection(db, 'blogs');
            const blogsSnapshot = await getDocs(blogsCollection);
            allBlogs = blogsSnapshot.docs.map(doc => ({
                id: doc.id,
                ...doc.data()
            }));
            
            displayTopBlogs();
            displayAllBlogs();
            displayManageBlogs();
            displayAnalytics();
            loadTop10Blogs();
        }

        function displayTopBlogs() {
            const topBlogsContainer = document.getElementById('top-blogs');
            const sortedBlogs = [...allBlogs].sort((a, b) => (b.likes || 0) - (a.likes || 0));
            const topThree = sortedBlogs.slice(0, 3);
            
            const badges = ['ü•á #1', 'ü•à #2', 'ü•â #3'];
            const badgeClasses = ['', 'second', 'third'];
            
            topBlogsContainer.innerHTML = topThree.map((blog, index) => `
                <div class="blog-card" onclick="navigateTo('blog', '${blog.id}')">
                    <span class="top-badge ${badgeClasses[index]}">${badges[index]}</span>
                    <h3>${blog.title}</h3>
                    <p>${blog.content.substring(0, 100)}...</p>
                    <div class="blog-stats">
                        <span class="stat">‚ù§Ô∏è ${blog.likes || 0}</span>
                        <span class="stat">üîó ${blog.shares || 0}</span>
                        <span class="stat">üí¨ ${blog.commentCount || 0}</span>
                    </div>
                    <div class="blog-meta">
                        <span>${new Date(blog.createdAt).toLocaleDateString()}</span>
                    </div>
                </div>
            `).join('');
        }

        function displayAllBlogs() {
            const allBlogsContainer = document.getElementById('all-blogs');
            allBlogsContainer.innerHTML = allBlogs.map(blog => `
                <div class="blog-card" onclick="navigateTo('blog', '${blog.id}')">
                    <h3>${blog.title}</h3>
                    <p>${blog.content.substring(0, 100)}...</p>
                    <div class="blog-stats">
                        <span class="stat">‚ù§Ô∏è ${blog.likes || 0}</span>
                        <span class="stat">üîó ${blog.shares || 0}</span>
                        <span class="stat">üí¨ ${blog.commentCount || 0}</span>
                    </div>
                    <div class="blog-meta">
                        <span>${new Date(blog.createdAt).toLocaleDateString()}</span>
                    </div>
                </div>
            `).join('');
        }

        function displayManageBlogs() {
            const tableBody = document.getElementById('manage-blogs-table');
            tableBody.innerHTML = allBlogs.map(blog => `
                <tr>
                    <td>${blog.title}</td>
                    <td>${new Date(blog.createdAt).toLocaleDateString()}</td>
                    <td>${blog.likes || 0}</td>
                    <td>${blog.shares || 0}</td>
                    <td>${blog.commentCount || 0}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn edit-btn" onclick="editBlog('${blog.id}')">Edit</button>
                            <button class="action-btn delete-btn" onclick="deleteBlog('${blog.id}')">Delete</button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function displayAnalytics() {
            applyAnalyticsFilters();
        }

        window.applyAnalyticsFilters = function() {
            const metricFilter = document.getElementById('metric-filter').value;
            const periodFilter = document.getElementById('period-filter').value;
            
            let filteredBlogs = [...allBlogs];
            
            if (periodFilter !== 'all') {
                const now = new Date();
                const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
                const monthAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);
                
                filteredBlogs = filteredBlogs.filter(blog => {
                    const blogDate = new Date(blog.createdAt);
                    if (periodFilter === 'week') return blogDate >= weekAgo;
                    if (periodFilter === 'month') return blogDate >= monthAgo;
                    return true;
                });
            }
            
            if (metricFilter !== 'all') {
                filteredBlogs.sort((a, b) => (b[metricFilter] || 0) - (a[metricFilter] || 0));
            }
            
            const tableBody = document.getElementById('analytics-table');
            tableBody.innerHTML = filteredBlogs.map(blog => {
                const engagement = (blog.likes || 0) + (blog.shares || 0) + (blog.commentCount || 0);
                return `
                    <tr>
                        <td>${blog.title}</td>
                        <td>${blog.likes || 0}</td>
                        <td>${blog.shares || 0}</td>
                        <td>${blog.commentCount || 0}</td>
                        <td><strong>${engagement}</strong></td>
                        <td>${new Date(blog.createdAt).toLocaleDateString()}</td>
                    </tr>
                `;
            }).join('');
        };

        window.sortAnalytics = function(column) {
            if (currentSortColumn === column) {
                currentSortDirection = currentSortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                currentSortColumn = column;
                currentSortDirection = 'desc';
            }
            
            document.querySelectorAll('.sort-indicator').forEach(el => el.textContent = '');
            document.getElementById(`sort-${column}`).textContent = currentSortDirection === 'asc' ? '‚Üë' : '‚Üì';
            
            const tableBody = document.getElementById('analytics-table');
            const rows = Array.from(tableBody.querySelectorAll('tr'));
            
            rows.sort((a, b) => {
                let aVal, bVal;
                const cells = {
                    a: a.querySelectorAll('td'),
                    b: b.querySelectorAll('td')
                };
                
                switch(column) {
                    case 'title': 
                        aVal = cells.a[0].textContent;
                        bVal = cells.b[0].textContent;
                        break;
                    case 'likes': 
                        aVal = parseInt(cells.a[1].textContent);
                        bVal = parseInt(cells.b[1].textContent);
                        break;
                    case 'shares': 
                        aVal = parseInt(cells.a[2].textContent);
                        bVal = parseInt(cells.b[2].textContent);
                        break;
                    case 'comments': 
                        aVal = parseInt(cells.a[3].textContent);
                        bVal = parseInt(cells.b[3].textContent);
                        break;
                    case 'engagement': 
                        aVal = parseInt(cells.a[4].textContent);
                        bVal = parseInt(cells.b[4].textContent);
                        break;
                    case 'date': 
                        aVal = new Date(cells.a[5].textContent);
                        bVal = new Date(cells.b[5].textContent);
                        break;
                }
                
                if (currentSortDirection === 'asc') {
                    return aVal > bVal ? 1 : -1;
                } else {
                    return aVal < bVal ? 1 : -1;
                }
            });
            
            tableBody.innerHTML = '';
            rows.forEach(row => tableBody.appendChild(row));
        };

        window.loadTop10Blogs = function() {
            const sortBy = document.getElementById('top10-sort').value;
            const sortedBlogs = [...allBlogs].sort((a, b) => (b[sortBy] || 0) - (a[sortBy] || 0));
            const top10 = sortedBlogs.slice(0, 10);
            
            const tableBody = document.getElementById('top10-table');
            tableBody.innerHTML = top10.map((blog, index) => {
                const engagement = (blog.likes || 0) + (blog.shares || 0) + (blog.commentCount || 0);
                return `
                    <tr>
                        <td><strong>#${index + 1}</strong></td>
                        <td>${blog.title}</td>
                        <td>${blog.likes || 0}</td>
                        <td>${blog.shares || 0}</td>
                        <td>${blog.commentCount || 0}</td>
                        <td><strong>${engagement}</strong></td>
                        <td>${new Date(blog.createdAt).toLocaleDateString()}</td>
                    </tr>
                `;
            }).join('');
        };

        window.sortTop10 = function(column) {
            if (top10SortColumn === column) {
                top10SortDirection = top10SortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                top10SortColumn = column;
                top10SortDirection = 'desc';
            }
            
            document.querySelectorAll('[id^="top10-sort-"]').forEach(el => el.textContent = '');
            document.getElementById(`top10-sort-${column}`).textContent = top10SortDirection === 'asc' ? '‚Üë' : '‚Üì';
            
            const tableBody = document.getElementById('top10-table');
            const rows = Array.from(tableBody.querySelectorAll('tr'));
            
            rows.sort((a, b) => {
                const aVal = parseInt(a.querySelectorAll('td')[column === 'likes' ? 2 : column === 'shares' ? 3 : 4].textContent);
                const bVal = parseInt(b.querySelectorAll('td')[column === 'likes' ? 2 : column === 'shares' ? 3 : 4].textContent);
                
                if (top10SortDirection === 'asc') {
                    return aVal - bVal;
                } else {
                    return bVal - aVal;
                }
            });
            
            tableBody.innerHTML = '';
            rows.forEach((row, index) => {
                row.querySelector('td').innerHTML = `<strong>#${index + 1}</strong>`;
                tableBody.appendChild(row);
            });
        };

        window.navigateTo = function(page, id = null) {
            document.querySelectorAll('[id$="-page"]').forEach(p => p.classList.add('hidden'));
            
            if (page === 'blog' && id) {
                const blog = allBlogs.find(b => b.id === id);
                if (blog) {
                    displayBlogDetail(blog);
                    document.getElementById('blog-detail-page').classList.remove('hidden');
                    window.history.pushState({page: 'blog', id}, '', `#blog/${id}`);
                }
            } else {
                document.getElementById(`${page}-page`).classList.remove('hidden');
                window.history.pushState({page}, '', `#${page}`);
            }
            
            window.scrollTo(0, 0);
        };

        function displayBlogDetail(blog) {
            const commentsKey = `blog_comments_${blog.id}`;
            const savedComments = JSON.parse(localStorage.getItem(commentsKey) || '[]');
            
            const content = document.getElementById('blog-detail-content');
            content.innerHTML = `
                <h2>${blog.title}</h2>
                <div class="blog-meta">
                    <span>${new Date(blog.createdAt).toLocaleDateString()}</span>
                </div>
                <div class="blog-stats" style="margin: 20px 0;">
                    <span class="stat">‚ù§Ô∏è ${blog.likes || 0} Likes</span>
                    <span class="stat">üîó ${blog.shares || 0} Shares</span>
                    <span class="stat">üí¨ ${savedComments.length} Comments</span>
                </div>
                <p style="white-space: pre-wrap; line-height: 1.8;">${blog.content}</p>
                
                <div class="comment-section">
                    <h3>Comments (${savedComments.length})</h3>
                    
                    <form class="comment-form" onsubmit="handleCommentSubmit(event, '${blog.id}')">
                        <div class="form-group">
                            <label for="comment-author">Your Name</label>
                            <input type="text" id="comment-author" required>
                        </div>
                        <div class="form-group">
                            <label for="comment-text">Your Comment</label>
                            <textarea id="comment-text" required></textarea>
                        </div>
                        <button type="submit" class="submit-button">Post Comment</button>
                    </form>
                    
                    <div class="comment-list" id="comment-list-${blog.id}">
                        ${savedComments.map(comment => `
                            <div class="comment-item">
                                <div class="comment-author">${comment.author}</div>
                                <div class="comment-date">${new Date(comment.date).toLocaleString()}</div>
                                <div class="comment-text">${comment.text}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        window.handleCommentSubmit = async function(event, blogId) {
            event.preventDefault();
            
            const author = document.getElementById('comment-author').value;
            const text = document.getElementById('comment-text').value;
            
            const comment = {
                author,
                text,
                date: new Date().toISOString()
            };
            
            const commentsKey = `blog_comments_${blogId}`;
            const savedComments = JSON.parse(localStorage.getItem(commentsKey) || '[]');
            savedComments.push(comment);
            localStorage.setItem(commentsKey, JSON.stringify(savedComments));
            
            const blog = allBlogs.find(b => b.id === blogId);
            const blogRef = doc(db, 'blogs', blogId);
            await updateDoc(blogRef, {
                commentCount: savedComments.length
            });
            
            blog.commentCount = savedComments.length;
            
            event.target.reset();
            
            displayBlogDetail(blog);
            displayTopBlogs();
            displayAllBlogs();
            displayManageBlogs();
            displayAnalytics();
            loadTop10Blogs();
        };

        window.handleBlogSubmit = async function(event) {
            event.preventDefault();
            
            const title = document.getElementById('blog-title').value;
            const content = document.getElementById('blog-content').value;
            
            await addDoc(collection(db, 'blogs'), {
                title,
                content,
                createdAt: new Date().toISOString(),
                likes: 0,
                shares: 0,
                commentCount: 0
            });
            
            event.target.reset();
            alert('Blog published successfully!');
            await loadBlogs();
        };

        window.handleContactSubmit = function(event) {
            event.preventDefault();
            alert('Thank you for your message! I will get back to you soon.');
            event.target.reset();
        };

        window.switchAdminTab = function(tab) {
            document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.admin-content').forEach(c => c.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(`${tab}-content`).classList.add('active');
        };

        window.editBlog = async function(id) {
            const blog = allBlogs.find(b => b.id === id);
            const newTitle = prompt('Edit title:', blog.title);
            const newContent = prompt('Edit content:', blog.content);
            
            if (newTitle && newContent) {
                const blogRef = doc(db, 'blogs', id);
                await updateDoc(blogRef, {
                    title: newTitle,
                    content: newContent
                });
                await loadBlogs();
            }
        };

        window.deleteBlog = async function(id) {
            if (confirm('Are you sure you want to delete this blog?')) {
                await deleteDoc(doc(db, 'blogs', id));
                await loadBlogs();
            }
        };

        window.addEventListener('popstate', function(event) {
            if (event.state) {
                navigateTo(event.state.page, event.state.id);
            }
        });

        const hash = window.location.hash.slice(1);
        if (hash.startsWith('blog/')) {
            const id = hash.split('/')[1];
            navigateTo('blog', id);
        } else if (hash) {
            navigateTo(hash);
        }

        loadBlogs();
    </script>
</body>
</html>